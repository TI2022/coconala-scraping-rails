<%= provide(:title, 'レシートから作成') %>
<%= provide(:class_text, 'account--form') %>
<div class="min-separator"></div>
<%= form_with(model: @account, url: ocr_upload_accounts_path, local: true, method: :post) do |f| %>
  <%= f.fields_for :compound_journals do |c_j| %>
    <%= render 'shared/error_messages', object: f.object %>
    <div class="container">
      <div class="row">
        <div class="col-md-6 col-md-offset-3">
          <div class="min-separator"></div>
          <h2 class="ocr-title">レシートを選択してください</h2>

          <div class="text-right">
            <div class="btn btn-info text-right qa">Q&A <b class="caret"></b></div>
          </div>
          <div class="min-separator"></div>
          <div class="qa-body">
            <div class="app-description">フリーランスの人が１人でカフェで仕事をした場合、経費にすることが可能です。その場合の勘定科目は「会議費」になります。<br />「飲み物代」だけで「食べ物代」は経費になりません。</div>
            <div class="min-separator"></div>
            <div class="app-description">ただし、仕事上で研究や視察を目的とした「飲食代」は経費になるようです。<br />その場合、税務調査でプライベートと疑われないためにも、<br />撮影写真やレポートなどの「証拠」を残しておくとよいです。<br />勘定科目は「研究費」がおすすめです。</div>
            <div class="min-separator"></div>
          </div>

          <div class="app-description center">
            <%= f.file_field :image, id: :menu_img %>
            <div class="min-separator"></div>
            <div>
              <% if @account.image.present? %>
                <%= image_tag @account.image.url, width: "50%", class: "image-border", id: :menu_img_prev %>
              <% else %>
                <%= image_tag "/no-image.png", width: "50%", class: "image-border", id: :menu_img_prev %>
              <% end %>
            </div>
          </div>
          <div class="min-separator"></div>
          <div class="btn-space">
            <%= f.submit "登録", class: "btn btn-block btn-primary" %>
          </div>
          
          <div class="ocr-accounting-date">
            <%= f.label :accounting_date, class: "required label-#{yield(:class_text)}" %>
            <%= f.date_field :accounting_date, value: @today, required: true, class: "form-control" %>
            <div class="min-separator"></div>
            <div class="ocr-right-accounting-title">
              <div class="required font-bold">貸方<%= c_j.label :account_title, class: "label-#{yield(:class_text)}" %></div>
              <%= c_j.select :right_account_title, @ocr_right_account_titles, {include_blank: true}, class: "form-control" %>
            </div>
            <div class="ocr-accounting-title">
              <div class="required font-bold">借方<%= c_j.label :account_title, class: "label-#{yield(:class_text)}" %></div>
              <%= c_j.select :account_title, @ocr_account_titles, {include_blank: true}, class: "form-control" %>
            </div>
          </div>
          <div class="min-separator"></div>
        </div> <!-- <div class="col-md-6 col-md-offset-3"> -->
      </div>  <!-- <div class="row"> -->
    <% end %>
  <% end %>

  <div class="container">
    <% if @tags.present? %>
      <div id="draggablePanelList" class="list-unstyled">
        <span class="panel panel-info">
            <span class="panel-heading"><%= @tags[0][1] %></span>
        </span>
        <span class="panel panel-info">
            <span class="panel-heading"><%= @tags[1][1] %></span>
        </span>
        <span class="panel panel-info">
            <span class="panel-heading"><%= @tags[2][1] %></span>
        </span>
        <span class="panel panel-info">
            <span class="panel-heading"><%= @tags[3][1] %></span>
        </span>
      </div>
    <% end %> 
    <div class="row">
      <div class="col-12">
        <div id="draggablePanelList2" class="">
            <div class="panel panel-default">
                <div class="panel-heading">You cand drag this panel.</div>
                <div class="panel-body">Content hedfsre ...</div>
            </div>
            <div class="panel panel-danger">
                <div class="panel-heading">You canfd drag this panel.</div>
                <div class="panel-body">Content hdsfere ...</div>
            </div>
        </div>
      </div><!--end col-->
    </div><!--end row-->
  </div> <!-- <div class="container"> -->
</div> <!-- <div class="container"> -->

<script>
  $(function() {
    function readURL(input) {
        if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function (e) {
    $('#menu_img_prev').attr('src', e.target.result);
        }
        reader.readAsDataURL(input.files[0]);
        }
    }
    $("#menu_img").change(function(){
      readURL(this);
      $('.ocr-accounting-date').show();
      $('.ocr-accounting-title').show();
      $('.ocr-right-accounting-title').show();
      $('.ocr-title').hide();
    });

    $('.ocr-accounting-date').hide();
    $('.ocr-accounting-title').hide();
    $('.ocr-right-accounting-title').hide();

    $(".qa-body").hide();
    $(".qa").on('click', function() {
      $(".qa-body").toggle();
    });
  });

  // draggable用
  jQuery(function($) {
    var panelList = $('#draggablePanelList');

    panelList.sortable({
        // Only make the .panel-heading child elements support dragging.
        // Omit this to make then entire <li>...</li> draggable.
        handle: '.panel-heading', 
        update: function() {
            $('.panel', panelList).each(function(index, elem) {
              var $listItem = $(elem),
                  newIndex = $listItem.index();
                // Persist the new indices.
            });
        }
    });
  });
  jQuery(function($) {
    var panelList2 = $('#draggablePanelList2');
    panelList2.sortable({
        // Only make the .panel-heading child elements support dragging.
        // Omit this to make then entire <li>...</li> draggable.
        handle: '.panel-heading', 
        update: function() {
            $('.panel', panelList2).each(function(index, elem) {
              var $listItem = $(elem),
                  newIndex = $listItem.index();

                // Persist the new indices.
            });
        }
    });
  });

  // Q＆A用
  

</script>